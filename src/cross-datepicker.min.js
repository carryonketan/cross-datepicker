/**
 *
 *  Cross-DatePicker
 *  Version 0.2
 *
 *  @lcnvdl
 *  http://www.lucianorasente.com
 *
 */
(function(){var a=function(d){return typeof d==="number"?d?d<0?-1:1:d===d?0:NaN:NaN};var b=function(d){return true};$.fn.insertAt=$.fn.insertAt||function(d,e){return this.each(function(){if(d===0){e.prepend(this)}else{e.children().eq(d-1).after(this)}})};var c=function(F,v){if(F.data("cross-datepicker")){return this}F.attr("type","text");v=$.extend({},$.fn.cdp.defaults,v);if(v.hideInput){F.hide()}var C=$("<div>").addClass(v.classes.container||"").data("input",F).insertBefore(F);var l=[31,29,31,30,31,30,31,31,30,31,30,31];var G=$("<select>").addClass(v.classes.controls||"").addClass(v.classes.days||""),x=$("<select>").addClass(v.classes.controls||"").addClass(v.classes.months||""),q=$("<select>").addClass(v.classes.controls||"").addClass(v.classes.year||"");var A=function(H){var y={},m="",d=0,o={d:G,m:x,y:q};for(var e=0,I=H;e<I.length;e++){var J=I[e];if(m==J){y[J].count++}else{if(J=="d"||J=="y"||J=="m"){y[J]={count:1,order:d++,e:o[J]};o[J].data("order",y[J].order);m=J}}if(d>3){throw"Invalid date format"}}return y};var k=A(v.inputFormat),E=A(v.format);for(var D in E){E[D].e.appendTo(C)}C.sort(function(e,d){if(e.data("order")>d.data("order")){return 1}else{if(e.data("order")<d.data("order")){return -1}else{return 0}}});var z=function(d,e){var f=String(d),i=e||E.d.count;while(i>f.length){f="0"+f}return f};var r=function(e,d){if(e>12){throw"Invalid month: "+e}var i=d||E.m.count,f=String(e);if(i==2){if(f.length==1){f="0"+f}}else{if(i==3){f=v.months[D-1].substr(0,3)}else{if(i==4){f=v.months[D-1]}else{throw"Invalid month format"}}}return f};var j=function(d,e){var f=String(d),i=e||E.y.count;if(i==2){f=f.substr(f.length-2,2)}else{if(i!=4){throw"Invalid year format"}}return f};var u=function(d,e){};var t=function(J,m,I,f,M){var K=["d","m","y"],N=J;if(typeof M==="string"){M=parseInt(M)}if(typeof f==="string"){f=parseInt(f)}if(typeof I==="string"){I=parseInt(I)}for(var H=0;H<K.length;H++){var d=K[H],L=m[d],e="",y="";for(var o=0;o<L.count;o++){e+=d}if(d=="d"){y=z(M,L.count)}else{if(d=="m"){y=r(f,L.count)}else{y=j(I,L.count)}}N=N.replace(e,y)}return N};var p=function(){F.val(t(v.inputFormat,k,q.val(),x.val(),G.val()))};this.updateInput=function(){p()};var g=function(){};G.data("days",0);var s=function(f){if(G.data("days")==l[f-1]){return}var e=parseInt(G.val()||"1");G.html("");if(f==0){return}if(v.addNullOption){G.append("<option value=''>"+v.nullOptionText+"</option>")}for(var d=1;d<=l[f-1];d++){$("<option>").attr("value",d).text(z(d)).appendTo(G)}G.val(e)};G.change(function(){p()});s(1);x.change(function(){s(parseInt($(this).val()));p()});if(v.addNullOption){x.append("<option value='0'>"+v.nullOptionText+"</option>")}for(var D=1;D<=12;D++){x.append("<option value='"+D+"'>"+r(D)+"</option>")}var B,h;if(typeof v.years[0]=="string"){var w=new Date().getFullYear(),n;if(v.years.length==3){w+=v.years[1];n=v.years[2]}else{n=v.years[1]}for(var D=w;D!=w+n;D+=a(n)){q.append("<option value='"+D+"'>"+j(D)+"</option>")}}else{for(var D=v.years[0];D!=v.years[1];D+=a(v.years[1]-v.years[0])){q.append("<option value='"+D+"'>"+j(D)+"</option>")}}q.change(function(){p()});this.inputs={d:G,y:q,m:x};if(F.data("initial-day")){$(function(){$.fn.cdp.statics.fns.set(F,[F.data("initial-year"),F.data("initial-month"),F.data("initial-day")])})}p();F.data("cross-datepicker",this)};$.fn.cdp=function(h,d){var g=$(this);if(g.length==0){return this}else{if(g.length>1){g.each(function(){$(this).cdp(h)});return this}}if(!g.is("input")){throw"You can apply Cross-DatePicker only on an 'input' element"}if(typeof h==="string"){var f=$.fn.cdp.statics;if(!f.fns[h]){console.error("Unknown function "+h)}f.fns[h](g,d);return this}var i=new c(g,h);return this};$.fn.cdp.defaults={hideInput:true,format:"d/mmm/yyyy",inputFormat:"yyyy-mm-dd",years:["now",-100],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],addNullOption:false,nullOptionText:"Select",classes:{container:"cdp-container",controls:"cdp-select",days:"cdp-d",months:"cdp-m",years:"cdp-y"}};$.fn.cdp.statics={fns:{set:function(j,g){var h=$.fn.cdp.statics,i=j.data("cross-datepicker"),l,f,k;if($.isArray(g)){l=g[0];f=g[1];k=g[2]}else{l=g.year||g.y;f=g.month||g.m;k=g.day||g.d}i.inputs.y.val(String(l));i.inputs.m.val(String(f));i.inputs.d.val(String(k));i.updateInput()}}}})();